import{H as I,p as e,x as k,y as X,J as Z,G as W}from"./chunk-WWGJGFF6-C1k8rglg.js";import{u as ee,j as se,E as le}from"./gql-BN5l4yyr.js";import{b as re}from"./index-DrVPcFH7.js";import{I as R,p as ae,g as te}from"./visualization.queries-BwJN6T7Z.js";import{B as ce}from"./budget-detail-skeleton-D_sBCfx1.js";import{f as d,b as de,c as ne,h as ie,g as xe,d as oe,e as me,i as pe}from"./helpers-DAjGluMj.js";import{V as O}from"./VoteButtons-CPWQknyN.js";import"./middleware-BA_Oq8-J.js";import"./mutation-BvWU_GRy.js";const Q=()=>e.jsx("hr",{style:{width:"2px"}}),be=({date:x,title:s,isFirst:t,historicalProposalId:c})=>{const o=I(),n=()=>{c&&o(`/budget/${c}`)};return e.jsxs("li",{children:[!t&&e.jsx(Q,{}),e.jsx("div",{className:"timeline-middle",children:e.jsx("div",{className:"h-3 w-3 rounded-full bg-gray-900"})}),e.jsx("div",{className:"timeline-end rounded-xl bg-transparent px-6 py-4 md:px-0",children:e.jsxs("div",{className:"flex items-center justify-between md:w-[200px] md:max-w-[200px]",children:[e.jsx("div",{className:"min-w-0 text-gray-900",children:e.jsxs("div",{className:"md:text-md text-base leading-7 font-normal md:leading-8",children:[e.jsx("time",{className:"font-inherit leading-inherit align-middle text-inherit lg:underline",children:x}),e.jsx("span",{className:"align-middle",children:s})]})}),c&&e.jsx("button",{type:"button",onClick:n,className:"ml-4 shrink-0 rounded-lg border border-black bg-white p-1 text-sm font-medium text-neutral-500 md:max-w-[44px] md:px-0 md:text-xs",children:"看版本變更"})]})}),e.jsx(Q,{})]})},q=({items:x})=>e.jsx("ul",{className:"timeline timeline-vertical timeline-compact",children:x.map((s,t)=>e.jsx(be,{...s,isLast:t===x.length-1,isFirst:t===0},s.id))}),he=({isDesktop:x,proposal:s,timelineData:t,mergedProposalsData:c,hasMerged:o,hasImage:n,proposerName:l,cosignersText:P,proposalType:C,resultText:S,parentProposalId:j,hasHistoricalProposals:r,budgetCategoryDisplay:f,projectDescriptionDisplay:g,lastYearSettlementDisplay:Y,lastYearLegalBudgetDisplay:B,lastYearComparisonDisplay:L,showLastYearSection:T,shouldShowBudgetInfo:m,proposalKey:N})=>{var i,p,w,b,y,h,v;const u=(a,$,_="flex")=>!r&&!j?e.jsx("p",{className:a,children:S}):j?e.jsxs("p",{className:_,children:["請至",e.jsx(k,{to:`/budget/${j}`,className:$,children:"主提案單"}),"確認結果"]}):e.jsx("p",{className:_,children:"請至主提案單確認結果"});return x?e.jsx("div",{className:"pb-8 text-sm",children:e.jsxs("div",{className:"mx-2.5 flex flex-col md:mx-8",children:[e.jsx(k,{to:"/all-budgets",className:"underline",children:"<回到列表頁"}),e.jsxs("div",{className:"relative mx-auto mt-6 max-w-7xl 2xl:w-3xl",children:[e.jsx("div",{className:"absolute h-full w-full translate-x-3 -translate-y-3 rounded-lg border-2 bg-neutral-200"}),e.jsxs("div",{className:"bg-surface-base relative flex flex-col rounded-lg border-2 p-5 pb-30",children:[e.jsxs("div",{className:"mb-4 flex gap-5 border-b-2 p-3 text-xl font-bold",children:[e.jsx("p",{children:"編號"}),e.jsx("p",{className:"text-budget-warning",children:s.id})]}),e.jsxs("div",{className:"flex flex-col gap-y-10",children:[e.jsxs("section",{className:"flex",children:[e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"分類"}),e.jsx("p",{className:"flex w-fit border-t pt-4 md:pr-8 lg:pr-12",children:((i=s.government)==null?void 0:i.category)||"分類"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"部會"}),e.jsx("p",{className:"flex w-fit border-t pt-4 md:pr-8 lg:pr-12",children:((p=s.government)==null?void 0:p.name)||"部會名稱"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"提案人（連署）"}),e.jsxs("p",{className:"flex w-fit border-t pt-4 md:pr-18 lg:pr-32",children:[l,e.jsx("br",{}),"（",P,"）"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"提案"}),e.jsx("p",{className:"flex w-fit border-t pt-4 md:pr-12",children:C})]}),e.jsxs("div",{className:"grow",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"審議結果"}),u("flex border-t pt-4 pr-12 ","text-brand-primary flex underline","flex pt-4 border-t")]})]}),e.jsxs("section",{className:"flex",children:[e.jsxs("div",{className:"min-w-fit",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"審議階段"}),e.jsx("div",{className:"flex w-fit border-t pt-4 pr-13 md:pr-24",children:t.length>0?e.jsx(q,{items:t}):e.jsx("p",{className:"text-gray-500",children:"暫無審議資料"})})]}),e.jsxs("div",{className:"grow",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"是否併案"}),e.jsxs("div",{className:"flex flex-col gap-y-4 border-t pt-4",children:[e.jsx("p",{children:o?"是":"否"}),o&&c.length>0&&e.jsx("div",{className:"grid-rows-auto grid grid-cols-3 gap-4.5",children:c.map(a=>e.jsxs(k,{to:`/budget/${a.id}`,className:"hover:text-brand-primary flex gap-x-2 text-neutral-500",children:[e.jsx("div",{className:`mt-2 flex items-center justify-center rounded-full ${a.isParent?"bg-brand-primary size-5 min-w-5":"size-2 bg-black"}`,children:e.jsx("span",{className:`${a.isParent?"text-white":"hidden"}`,children:"主"})}),e.jsxs("div",{children:[e.jsx("p",{className:"underline",children:a.date}),e.jsx("p",{children:a.proposers})]})]},a.id))})]})]})]}),e.jsx("section",{className:"flex",children:e.jsxs("div",{className:"grow",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"提案內容"}),e.jsx("div",{className:"flex flex-col gap-y-4 border-t pt-4",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:s.reason||s.description||"無提案內容"})})]})}),!n&&e.jsxs("section",{className:"flex",children:[e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"預算金額"}),e.jsx("p",{className:"text-brand-accent flex w-fit border-t border-black pt-4 pr-32 font-bold",children:d((w=s.budget)==null?void 0:w.budgetAmount)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"減列金額"}),e.jsx("p",{className:"text-brand-accent flex w-fit border-t border-black pt-4 pr-[136px] font-bold",children:d(s.reductionAmount)})]}),e.jsxs("div",{className:"grow",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"凍結金額"}),e.jsx("p",{className:"text-brand-accent flex border-t border-black pt-4 font-bold",children:d(s.freezeAmount)})]})]}),n&&e.jsxs("section",{className:"flex",children:[e.jsxs("div",{id:"left",className:"flex w-6/11 flex-col",children:[e.jsxs("div",{className:"flex",children:[e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"預算金額"}),e.jsx("p",{className:"text-brand-accent flex w-fit border-t border-black pt-4 font-bold md:pr-8 lg:pr-16 xl:pr-32",children:d((b=s.budget)==null?void 0:b.budgetAmount)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"減列金額"}),e.jsx("p",{className:"text-brand-accent flex w-fit border-t border-black pt-4 font-bold md:pr-8 lg:pr-24 xl:pr-32",children:d(s.reductionAmount)})]}),e.jsxs("div",{className:"grow",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"凍結金額"}),e.jsx("p",{className:"text-brand-accent flex border-t border-black pt-4 pr-[93px] font-bold",children:d(s.freezeAmount)})]})]}),m&&e.jsxs("div",{className:"mt-9 flex max-w-5/6 flex-col gap-y-9",children:[e.jsxs("div",{className:"grow",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"科目/計畫"}),e.jsx("p",{className:"flex border-t border-black pt-4 pr-9",children:f})]}),e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"計畫說明"}),e.jsx("p",{className:"flex border-t border-black pt-4 whitespace-pre-wrap",children:g})]})]})]}),n&&e.jsxs("div",{id:"right",className:"w-5/11",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"提案單圖檔"}),e.jsx("div",{className:"flex border-t border-black pt-4 font-bold",children:e.jsx(R,{src:s.budgetImageUrl||"/icon/default-image.svg",alt:"proposal-image",className:"w-full shadow-md"})})]})]}),!n&&m&&e.jsxs("section",{className:"flex",children:[e.jsxs("div",{className:"grow",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"科目/計畫"}),e.jsx("p",{className:"flex border-t border-black pt-4 pr-9",children:f})]}),e.jsxs("div",{className:"w-[478px] max-w-[478px]",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"計畫說明"}),e.jsx("p",{className:"flex border-t border-black pt-4 whitespace-pre-wrap",children:g})]})]}),T&&e.jsxs("section",{className:"flex",children:[e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"上年度決算"}),e.jsx("p",{className:"flex w-fit border-t border-black pt-4 pr-[136px] font-bold",children:Y})]}),e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"上年度法定預算"}),e.jsx("p",{className:"flex w-fit border-t border-black pt-4 pr-[136px] font-bold",children:B})]}),e.jsxs("div",{className:"grow",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"與上年度比較"}),e.jsx("p",{className:"text-brand-primary flex border-t border-black pt-4 font-bold",children:L})]})]}),e.jsx("section",{className:"mt-25 flex justify-center gap-x-10",children:e.jsx(O,{proposal:s},N)})]})]})]})]})}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mx-2.5 mb-4 flex flex-col",children:[e.jsx(k,{to:"/all-budgets",className:"underline",children:"<回到列表頁"}),e.jsxs("div",{className:"mt-2 border-2 px-2 py-3",children:[e.jsxs("section",{className:"border-neutral-250 flex gap-6 border-b pb-2",children:[e.jsx("p",{children:"編號"}),e.jsx("p",{className:"text-budget-warning",children:s.id})]}),e.jsxs("section",{className:"border-neutral-250 mt-3 flex gap-10 border-b pb-4",children:[e.jsxs("div",{className:"flex flex-col gap-y-4 font-bold",children:[e.jsx("p",{children:"分類"}),e.jsx("p",{children:((y=s.government)==null?void 0:y.category)||"暫無分類"})]}),e.jsxs("div",{className:"flex flex-col gap-y-4 font-bold",children:[e.jsx("p",{children:"部會"}),e.jsx("p",{children:((h=s.government)==null?void 0:h.name)||"部會"})]})]}),e.jsxs("section",{children:[e.jsx("p",{className:"mt-3 text-lg font-bold",children:"審議階段"}),e.jsx("div",{children:t.length>0?e.jsx(q,{items:t}):e.jsx("p",{className:"text-gray-500",children:"暫無審議資料"})})]}),e.jsxs("div",{className:"mt-3 flex flex-col gap-y-3",children:[e.jsx("p",{className:"font-bold",children:"是否併案"}),e.jsx("p",{children:o?"是":"否"})]}),e.jsx("ul",{className:"timeline timeline-vertical timeline-compact text-neutral-500",children:c.map(a=>e.jsxs("li",{children:[e.jsx("div",{className:"timeline-middle",children:a.isParent?e.jsx("div",{className:"bg-brand-primary flex size-5 items-center justify-center rounded-full text-xs text-white",children:"主"}):e.jsx("div",{className:"size-2 rounded-full bg-black"})}),e.jsxs(k,{to:`/budget/${a.id}`,className:"timeline-end hover:text-brand-primary rounded-xl bg-transparent px-6 text-neutral-500",children:[e.jsx("p",{children:a.date}),e.jsx("p",{children:a.proposers})]})]},a.id))}),e.jsx("div",{className:"my-4 h-px w-full bg-gray-300"}),e.jsxs("div",{className:"flex flex-col gap-y-3",children:[e.jsx("p",{className:"font-bold",children:"提案人（連署）"}),e.jsxs("section",{children:[e.jsx("p",{children:l}),e.jsxs("p",{children:["（",P,"）"]})]})]}),e.jsx("div",{className:"my-4 h-px w-full bg-gray-300"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("section",{className:"flex gap-x-12",children:[e.jsxs("section",{className:"flex-col",children:[e.jsx("p",{className:"font-bold",children:"提案"}),e.jsx("p",{children:C})]}),e.jsxs("section",{className:"flex-col",children:[e.jsx("p",{className:"font-bold",children:"審議結果"}),u("flex pt-4 pr-12","text-brand-primary flex underline")]})]}),e.jsx("a",{href:"#",className:"underline",target:"_blank",children:"資料來源"})]}),e.jsx("div",{className:"my-4 h-px w-full bg-gray-300"}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-4 font-bold",children:"提案內容"}),e.jsx("p",{className:"whitespace-pre-wrap",children:s.reason||s.description||"無提案內容"})]}),e.jsx("div",{className:"my-4 h-px w-full bg-gray-300"}),e.jsxs("div",{className:"flex gap-x-10",children:[e.jsxs("section",{className:"flex flex-col gap-y-4",children:[e.jsx("p",{className:"font-bold",children:"預算金額"}),e.jsx("p",{className:"text-budget-warning",children:d((v=s.budget)==null?void 0:v.budgetAmount)})]}),e.jsxs("section",{className:"flex flex-col gap-y-4",children:[e.jsx("p",{className:"font-bold",children:"減列金額"}),e.jsx("p",{className:"text-budget-warning",children:d(s.reductionAmount)})]})]}),e.jsx("div",{className:"my-4 h-px w-full bg-gray-300"}),e.jsx("div",{className:"flex gap-x-10",children:e.jsxs("section",{className:"flex flex-col gap-y-4",children:[e.jsx("p",{className:"font-bold",children:"凍結金額"}),e.jsx("p",{className:"text-budget-warning",children:d(s.freezeAmount)})]})}),n&&e.jsx("div",{className:"my-4 h-px w-full bg-gray-300"}),e.jsx("div",{className:"flex gap-x-10",children:n&&e.jsxs("section",{className:"flex flex-col gap-y-4 px-3.5",children:[e.jsx("p",{className:"font-bold",children:"預算書圖檔"}),e.jsx(R,{src:s.budgetImageUrl??"",alt:"proposal-image",className:"w-full shadow-md"})]})}),m&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"my-4 h-px w-full bg-gray-300"}),e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx("p",{className:"font-bold",children:"科目/計畫"}),e.jsx("button",{children:e.jsx(R,{src:"/icon/explain-term.svg",alt:"explain-term",className:"size-5"})})]}),e.jsx("a",{href:"#",className:"text-brand-primary underline",target:"_blank",children:"預算書連結"})]}),e.jsx("p",{children:f}),e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx("p",{className:"font-bold",children:"計畫說明"}),e.jsx("button",{children:e.jsx(R,{src:"/icon/explain-term.svg",alt:"explain-term",className:"size-5"})})]}),e.jsx("p",{className:"whitespace-pre-wrap",children:g})]}),e.jsx("div",{className:"my-4 h-px w-full bg-gray-300"}),e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx("p",{className:"font-bold",children:"上年度決算"}),e.jsx("p",{children:Y})]}),e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx("p",{className:"font-bold",children:"上年度法定預算"}),e.jsx("p",{children:B})]}),e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx("p",{className:"font-bold",children:"與上年度比較"}),e.jsx("p",{children:L})]})]})]}),e.jsx("section",{className:"gird-rows-auto mt-11 grid items-center justify-items-center gap-10",children:e.jsx(O,{proposal:s},N)})]})]})})},je=()=>{var z,E,D,V,U,F;const{id:s}=Z(),t=re("(min-width: 768px)"),{data:c,isLoading:o,isError:n}=ee({queryKey:ae.detail(s),queryFn:()=>se(te,{id:s}),enabled:!!s});if(o)return e.jsx(ce,{isDesktop:t});if(n||!(c!=null&&c.proposal))return W(le);const l=c.proposal,P=de(l.meetings,l.historicalProposals),C=ne(l.mergedProposals,l.mergedParentProposals,l),S=ie(l),j=!!l.budgetImageUrl,r=l.budget,f=(z=l.proposers)==null?void 0:z.map(A=>A.name).join("、"),g=l.coSigners&&l.coSigners.length>0?l.coSigners.map(A=>A.name).join("、"):"無",Y=xe(l.proposalTypes),B=oe(l.result),L=((E=l.historicalParentProposals)==null?void 0:E.id)??((D=l.mergedParentProposals)==null?void 0:D.id),T=me((V=l.budget)==null?void 0:V.majorCategory,(U=l.budget)==null?void 0:U.mediumCategory,(F=l.budget)==null?void 0:F.minorCategory),m=!!(r!=null&&r.majorCategory)||!!(r!=null&&r.mediumCategory)||!!(r!=null&&r.minorCategory),N=(r==null?void 0:r.projectDescription)??"",u=N.trim().length>0,i=r,p=r==null?void 0:r.lastYearSettlement,w=p!=null,b=(i==null?void 0:i.lastYearLegalBudget)??null,y=b!=null,h=(i==null?void 0:i.lastYearComparison)??null,v=h!=null,a=m||u||w||y||v,$=m?T:"",_=u?N:"",G=w?d(p):"",K=y?d(b):"",M=v?d(h):"",J=!1,H=`${l.id}-${l.react_good}-${l.react_angry}-${l.react_disappoint}-${l.react_whatever}`;return e.jsx(he,{isDesktop:t,proposal:l,timelineData:P,mergedProposalsData:C,hasMerged:S,hasImage:j,proposerName:f||"",cosignersText:g,proposalType:Y,resultText:B,parentProposalId:L,hasHistoricalProposals:pe(l),budgetCategoryDisplay:$,projectDescriptionDisplay:_,lastYearSettlementDisplay:G,lastYearLegalBudgetDisplay:K,lastYearComparisonDisplay:M,showLastYearSection:J,shouldShowBudgetInfo:a,proposalKey:H})},Ce=X(je);export{Ce as default};
