import{H,p as e,x as y,y as X,J as Z,G as W}from"./chunk-FGUA77HG-BrA7_UWl.js";import{u as ee,j as se,E as le}from"./gql-B-mwqB7Q.js";import{b as re}from"./index-D4o5tLmX.js";import{I as _,p as ae,f as te}from"./visualization.queries-9AKN3csb.js";import{B as ce}from"./budget-detail-skeleton-DdreXLgs.js";import{f as d,b as de,c as ne,h as ie,g as xe,d as oe,e as me,i as pe}from"./helpers-j5VDf7UR.js";import{V as I}from"./VoteButtons-B_tIkJpM.js";import"./middleware-CqloAJtN.js";import"./mutation-bWlc2WXD.js";const O=()=>e.jsx("hr",{style:{width:"2px"}}),be=({date:i,title:s,isFirst:t,historicalProposalId:c})=>{const x=H(),o=()=>{c&&x(`/budget/${c}`)};return e.jsxs("li",{children:[!t&&e.jsx(O,{}),e.jsx("div",{className:"timeline-middle",children:e.jsx("div",{className:"h-3 w-3 rounded-full bg-gray-900"})}),e.jsx("div",{className:"timeline-end rounded-xl bg-transparent px-6 py-4 md:px-0",children:e.jsxs("div",{className:"flex items-center justify-between md:w-[200px] md:max-w-[200px]",children:[e.jsx("div",{className:"min-w-0 text-gray-900",children:e.jsxs("div",{className:"md:text-md text-base leading-7 font-normal md:leading-8",children:[e.jsx("time",{className:"font-inherit leading-inherit align-middle text-inherit lg:underline",children:i}),e.jsx("span",{className:"align-middle",children:s})]})}),c&&e.jsx("button",{type:"button",onClick:o,className:"ml-4 shrink-0 rounded-lg border border-black bg-white p-1 text-sm font-medium text-neutral-500 md:max-w-[44px] md:px-0 md:text-xs",children:"看版本變更"})]})}),e.jsx(O,{})]})},Q=({items:i})=>e.jsx("ul",{className:"timeline timeline-vertical timeline-compact",children:i.map((s,t)=>e.jsx(be,{...s,isLast:t===i.length-1,isFirst:t===0},s.id))}),he=({isDesktop:i,proposal:s,timelineData:t,mergedProposalsData:c,hasMerged:x,hasImage:o,proposerName:l,cosignersText:k,proposalType:P,resultText:R,parentProposalId:C,hasHistoricalProposals:r,budgetCategoryDisplay:j,projectDescriptionDisplay:f,lastYearSettlementDisplay:Y,lastYearLegalBudgetDisplay:B,lastYearComparisonDisplay:L,showLastYearSection:S,shouldShowBudgetInfo:m,proposalKey:g})=>{var n,p,u,b,w,h,v;const N=(a,T,A="flex")=>!r||!C?e.jsx("p",{className:a,children:R}):e.jsxs("p",{className:A,children:["請至",e.jsx(y,{to:`/budget/${C}`,className:T,children:"主提案單"}),"確認結果"]});return i?e.jsx("div",{className:"pb-8 text-sm",children:e.jsxs("div",{className:"mx-2.5 flex flex-col md:mx-8",children:[e.jsx(y,{to:"/all-budgets",className:"underline",children:"<回到列表頁"}),e.jsxs("div",{className:"relative mt-6",children:[e.jsx("div",{className:"absolute h-full w-full translate-x-3 -translate-y-3 rounded-lg border-2 bg-neutral-200"}),e.jsxs("div",{className:"bg-surface-base relative flex flex-col rounded-lg border-2 p-5 pb-30",children:[e.jsxs("div",{className:"mb-4 flex gap-5 border-b-2 p-3 text-xl font-bold",children:[e.jsx("p",{children:"編號"}),e.jsx("p",{className:"text-budget-warning",children:s.id})]}),e.jsxs("div",{className:"flex flex-col gap-y-10",children:[e.jsxs("section",{className:"flex",children:[e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"分類"}),e.jsx("p",{className:"flex w-fit border-t pt-4 md:pr-8 lg:pr-12",children:((n=s.government)==null?void 0:n.category)||"分類"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"部會"}),e.jsx("p",{className:"flex w-fit border-t pt-4 md:pr-8 lg:pr-12",children:((p=s.government)==null?void 0:p.name)||"部會名稱"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"提案人（連署）"}),e.jsxs("p",{className:"flex w-fit border-t pt-4 md:pr-18 lg:pr-32",children:[l,e.jsx("br",{}),"（",k,"）"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"提案"}),e.jsx("p",{className:"flex w-fit border-t pt-4 md:pr-12",children:P})]}),e.jsxs("div",{className:"grow",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"審議結果"}),N("flex border-t pt-4 pr-12 ","text-brand-primary flex underline","flex pt-4")]})]}),e.jsxs("section",{className:"flex",children:[e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"審議階段"}),e.jsx("div",{className:"flex w-fit border-t pt-4 pr-13 md:pr-24",children:t.length>0?e.jsx(Q,{items:t}):e.jsx("p",{className:"text-gray-500",children:"暫無審議資料"})})]}),e.jsxs("div",{className:"grow",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"是否併案"}),e.jsxs("div",{className:"flex flex-col gap-y-4 border-t pt-4",children:[e.jsx("p",{children:x?"是":"否"}),x&&c.length>0&&e.jsx("div",{className:"grid-rows-auto grid grid-cols-3 gap-4.5",children:c.map(a=>e.jsxs(y,{to:`/budget/${a.id}`,className:"hover:text-brand-primary flex gap-x-2 text-neutral-500",children:[e.jsx("div",{className:`mt-2 size-2 rounded-full ${a.isParent?"bg-brand-primary":"bg-black"}`,children:"主"}),e.jsxs("div",{children:[e.jsx("p",{className:"underline",children:a.date}),e.jsx("p",{children:a.proposers})]})]},a.id))})]})]})]}),e.jsx("section",{className:"flex",children:e.jsxs("div",{className:"grow",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"提案內容"}),e.jsx("div",{className:"flex flex-col gap-y-4 border-t pt-4",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:s.reason||s.description||"無提案內容"})})]})}),!o&&e.jsxs("section",{className:"flex",children:[e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"預算金額"}),e.jsx("p",{className:"text-brand-accent flex w-fit border-t border-black pt-4 pr-32 font-bold",children:d((u=s.budget)==null?void 0:u.budgetAmount)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"減列金額"}),e.jsx("p",{className:"text-brand-accent flex w-fit border-t border-black pt-4 pr-[136px] font-bold",children:d(s.reductionAmount)})]}),e.jsxs("div",{className:"grow",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"凍結金額"}),e.jsx("p",{className:"text-brand-accent flex border-t border-black pt-4 font-bold",children:d(s.freezeAmount)})]})]}),o&&e.jsxs("section",{className:"flex",children:[e.jsxs("div",{id:"left",className:"flex w-6/11 flex-col",children:[e.jsxs("div",{className:"flex",children:[e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"預算金額"}),e.jsx("p",{className:"text-brand-accent flex w-fit border-t border-black pt-4 font-bold md:pr-8 lg:pr-16 xl:pr-32",children:d((b=s.budget)==null?void 0:b.budgetAmount)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"減列金額"}),e.jsx("p",{className:"text-brand-accent flex w-fit border-t border-black pt-4 font-bold md:pr-8 lg:pr-16 xl:pr-32",children:d(s.reductionAmount)})]}),e.jsxs("div",{className:"grow",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"凍結金額"}),e.jsx("p",{className:"text-brand-accent flex border-t border-black pt-4 pr-[93px] font-bold",children:d(s.freezeAmount)})]})]}),m&&e.jsxs("div",{className:"mt-9 flex max-w-5/6 flex-col gap-y-9",children:[e.jsxs("div",{className:"grow",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"科目/計畫"}),e.jsx("p",{className:"flex border-t border-black pt-4 pr-9",children:j})]}),e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"計畫說明"}),e.jsx("p",{className:"flex border-t border-black pt-4 whitespace-pre-wrap",children:f})]})]})]}),e.jsxs("div",{id:"right",className:"w-5/11",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"提案單圖檔"}),e.jsx("div",{className:"flex border-t border-black pt-4 font-bold",children:e.jsx(_,{src:s.budgetImageUrl||"/icon/default-image.svg",alt:"proposal-image",className:"w-full"})})]})]}),!o&&m&&e.jsxs("section",{className:"flex",children:[e.jsxs("div",{className:"grow",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"科目/計畫"}),e.jsx("p",{className:"flex border-t border-black pt-4 pr-9",children:j})]}),e.jsxs("div",{className:"w-[478px] max-w-[478px]",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"計畫說明"}),e.jsx("p",{className:"flex border-t border-black pt-4 whitespace-pre-wrap",children:f})]})]}),S&&e.jsxs("section",{className:"flex",children:[e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"上年度決算"}),e.jsx("p",{className:"flex w-fit border-t border-black pt-4 pr-[136px] font-bold",children:Y})]}),e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"上年度法定預算"}),e.jsx("p",{className:"flex w-fit border-t border-black pt-4 pr-[136px] font-bold",children:B})]}),e.jsxs("div",{className:"grow",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"與上年度比較"}),e.jsx("p",{className:"text-brand-primary flex border-t border-black pt-4 font-bold",children:L})]})]}),e.jsx("section",{className:"mt-25 flex justify-center gap-x-10",children:e.jsx(I,{proposal:s},g)})]})]})]})]})}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mx-2.5 mb-4 flex flex-col",children:[e.jsx(y,{to:"/all-budgets",className:"underline",children:"<回到列表頁"}),e.jsxs("div",{className:"mt-2 border-2 px-2 py-3",children:[e.jsxs("section",{className:"border-neutral-250 flex gap-6 border-b pb-2",children:[e.jsx("p",{children:"編號"}),e.jsx("p",{className:"text-budget-warning",children:s.id})]}),e.jsxs("section",{className:"border-neutral-250 mt-3 flex gap-10 border-b pb-4",children:[e.jsxs("div",{className:"flex flex-col gap-y-4 font-bold",children:[e.jsx("p",{children:"分類"}),e.jsx("p",{children:((w=s.government)==null?void 0:w.category)||"暫無分類"})]}),e.jsxs("div",{className:"flex flex-col gap-y-4 font-bold",children:[e.jsx("p",{children:"部會"}),e.jsx("p",{children:((h=s.government)==null?void 0:h.name)||"部會"})]})]}),e.jsxs("section",{children:[e.jsx("p",{className:"mt-3 text-lg font-bold",children:"審議階段"}),e.jsx("div",{children:t.length>0?e.jsx(Q,{items:t}):e.jsx("p",{className:"text-gray-500",children:"暫無審議資料"})})]}),e.jsxs("div",{className:"mt-3 flex flex-col gap-y-3",children:[e.jsx("p",{className:"font-bold",children:"是否併案"}),e.jsx("p",{children:x?"是":"否"})]}),e.jsx("ul",{className:"timeline timeline-vertical timeline-compact text-neutral-500",children:c.map(a=>e.jsxs("li",{children:[e.jsx("div",{className:"timeline-middle",children:a.isParent?e.jsx("div",{className:"bg-brand-primary flex size-5 items-center justify-center rounded-full text-xs text-white",children:"主"}):e.jsx("div",{className:"size-2 rounded-full bg-black"})}),e.jsxs(y,{to:`/budget/${a.id}`,className:"timeline-end hover:text-brand-primary rounded-xl bg-transparent px-6 text-neutral-500",children:[e.jsx("p",{children:a.date}),e.jsx("p",{children:a.proposers})]})]},a.id))}),e.jsx("div",{className:"my-4 h-px w-full bg-gray-300"}),e.jsxs("div",{className:"flex flex-col gap-y-3",children:[e.jsx("p",{className:"font-bold",children:"提案人（連署）"}),e.jsxs("section",{children:[e.jsx("p",{children:l}),e.jsxs("p",{children:["（",k,"）"]})]})]}),e.jsx("div",{className:"my-4 h-px w-full bg-gray-300"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("section",{className:"flex gap-x-12",children:[e.jsxs("section",{className:"flex-col",children:[e.jsx("p",{className:"font-bold",children:"提案"}),e.jsx("p",{children:P})]}),e.jsxs("section",{className:"flex-col",children:[e.jsx("p",{className:"font-bold",children:"審議結果"}),N("flex pt-4 pr-12","text-brand-primary flex underline")]})]}),e.jsx("a",{href:"#",className:"underline",target:"_blank",children:"資料來源"})]}),e.jsx("div",{className:"my-4 h-px w-full bg-gray-300"}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-4 font-bold",children:"提案內容"}),e.jsx("p",{className:"whitespace-pre-wrap",children:s.reason||s.description||"無提案內容"})]}),e.jsx("div",{className:"my-4 h-px w-full bg-gray-300"}),e.jsxs("div",{className:"flex gap-x-10",children:[e.jsxs("section",{className:"flex flex-col gap-y-4",children:[e.jsx("p",{className:"font-bold",children:"預算金額"}),e.jsx("p",{className:"text-budget-warning",children:d((v=s.budget)==null?void 0:v.budgetAmount)})]}),e.jsxs("section",{className:"flex flex-col gap-y-4",children:[e.jsx("p",{className:"font-bold",children:"減列金額"}),e.jsx("p",{className:"text-budget-warning",children:d(s.reductionAmount)})]})]}),e.jsx("div",{className:"my-4 h-px w-full bg-gray-300"}),e.jsxs("div",{className:"flex gap-x-10",children:[e.jsxs("section",{className:"flex flex-col gap-y-4",children:[e.jsx("p",{className:"font-bold",children:"凍結金額"}),e.jsx("p",{className:"text-budget-warning",children:d(s.freezeAmount)})]}),e.jsxs("section",{className:"flex flex-col gap-y-4",children:[e.jsx("p",{className:"font-bold",children:"預算書圖檔"}),e.jsx(_,{src:s.budgetImageUrl||"/icon/default-image.svg",alt:"default-image",className:"size-5"})]})]}),m&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"my-4 h-px w-full bg-gray-300"}),e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx("p",{className:"font-bold",children:"科目/計畫"}),e.jsx("button",{children:e.jsx(_,{src:"/icon/explain-term.svg",alt:"explain-term",className:"size-5"})})]}),e.jsx("a",{href:"#",className:"text-brand-primary underline",target:"_blank",children:"預算書連結"})]}),e.jsx("p",{children:j}),e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx("p",{className:"font-bold",children:"計畫說明"}),e.jsx("button",{children:e.jsx(_,{src:"/icon/explain-term.svg",alt:"explain-term",className:"size-5"})})]}),e.jsx("p",{className:"whitespace-pre-wrap",children:f})]}),e.jsx("div",{className:"my-4 h-px w-full bg-gray-300"}),e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx("p",{className:"font-bold",children:"上年度決算"}),e.jsx("p",{children:Y})]}),e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx("p",{className:"font-bold",children:"上年度法定預算"}),e.jsx("p",{children:B})]}),e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx("p",{className:"font-bold",children:"與上年度比較"}),e.jsx("p",{children:L})]})]})]}),e.jsx("section",{className:"gird-rows-auto mt-11 grid items-center justify-items-center gap-10",children:e.jsx(I,{proposal:s},g)})]})]})})},je=()=>{var z,E,D,V,U,F;const{id:s}=Z(),t=re("(min-width: 768px)"),{data:c,isLoading:x,isError:o}=ee({queryKey:ae.detail(s),queryFn:()=>se(te,{id:s}),enabled:!!s});if(x)return e.jsx(ce,{isDesktop:t});if(o||!(c!=null&&c.proposal))return W(le);const l=c.proposal,k=de(l.meetings,l.historicalProposals),P=ne(l.mergedProposals,l.mergedParentProposals),R=ie(l),C=!!l.budgetImageUrl,r=l.budget,j=(z=l.proposers)==null?void 0:z.map($=>$.name).join("、"),f=l.coSigners&&l.coSigners.length>0?l.coSigners.map($=>$.name).join("、"):"無",Y=xe(l.proposalTypes),B=oe(l.result),L=((E=l.historicalParentProposals)==null?void 0:E.id)??((D=l.mergedParentProposals)==null?void 0:D.id),S=me((V=l.budget)==null?void 0:V.majorCategory,(U=l.budget)==null?void 0:U.mediumCategory,(F=l.budget)==null?void 0:F.minorCategory),m=!!(r!=null&&r.majorCategory)||!!(r!=null&&r.mediumCategory)||!!(r!=null&&r.minorCategory),g=(r==null?void 0:r.projectDescription)??"",N=g.trim().length>0,n=r,p=r==null?void 0:r.lastYearSettlement,u=p!=null,b=(n==null?void 0:n.lastYearLegalBudget)??null,w=b!=null,h=(n==null?void 0:n.lastYearComparison)??null,v=h!=null,a=m||N||u||w||v,T=m?S:"",A=N?g:"",q=u?d(p):"",G=w?d(b):"",K=v?d(h):"",M=!1,J=`${l.id}-${l.react_good}-${l.react_angry}-${l.react_disappoint}-${l.react_whatever}`;return e.jsx(he,{isDesktop:t,proposal:l,timelineData:k,mergedProposalsData:P,hasMerged:R,hasImage:C,proposerName:j||"",cosignersText:f,proposalType:Y,resultText:B,parentProposalId:L,hasHistoricalProposals:pe(l),budgetCategoryDisplay:T,projectDescriptionDisplay:A,lastYearSettlementDisplay:q,lastYearLegalBudgetDisplay:G,lastYearComparisonDisplay:K,showLastYearSection:M,shouldShowBudgetInfo:a,proposalKey:J})},Ce=X(je);export{Ce as default};
