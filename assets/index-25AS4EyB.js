import{G as ae,p as e,y as re,I as te,D as ce,x as p}from"./chunk-4WY6JWTD-2Cr-QbDP.js";import{u as de,j as ne,E as ie}from"./gql-Mx7Ziu-8.js";import{I as m,p as oe,f as xe}from"./visualization.queries-BUVrj-cD.js";import{b as pe}from"./index-Ck08PhAW.js";import{B as me}from"./budget-detail-skeleton-DMxLzU0j.js";import{V as J}from"./VoteButtons-BlyMeqhI.js";import{b as he,c as be,h as je,g as ge,d as fe,e as Ne,f as a}from"./helpers-DCGy3gpM.js";import"./middleware-By82NwCX.js";import"./mutation-DIYO7IxG.js";const X=()=>e.jsx("hr",{style:{width:"2px"}}),ue=({date:i,title:t,isFirst:d,historicalProposalId:c})=>{const h=ae(),b=()=>{c&&h(`/budget/${c}`)};return e.jsxs("li",{children:[!d&&e.jsx(X,{}),e.jsx("div",{className:"timeline-middle",children:e.jsx("div",{className:"h-3 w-3 rounded-full bg-gray-900"})}),e.jsx("div",{className:"timeline-end rounded-xl bg-transparent px-6 py-4 md:px-0",children:e.jsxs("div",{className:"flex items-center justify-between md:w-[200px] md:max-w-[200px]",children:[e.jsx("div",{className:"min-w-0 text-gray-900",children:e.jsxs("div",{className:"md:text-md text-base leading-7 font-normal md:leading-8",children:[e.jsx("time",{className:"font-inherit leading-inherit align-middle text-inherit lg:underline",children:i}),e.jsx("span",{className:"align-middle",children:t})]})}),c&&e.jsx("button",{type:"button",onClick:b,className:"ml-4 shrink-0 rounded-lg border border-black bg-white p-1 text-sm font-medium text-neutral-500 md:max-w-[44px] md:px-0 md:text-xs",children:"看版本變更"})]})}),e.jsx(X,{})]})},Z=({items:i})=>e.jsx("ul",{className:"timeline timeline-vertical timeline-compact",children:i.map((t,d)=>e.jsx(ue,{...t,isLast:d===i.length-1,isFirst:d===0},t.id))}),we=()=>{var R,E,$,z,U,V,F,O,Q,K,M,q,G;const{id:t}=te(),d=pe("(min-width: 768px)"),{data:c,isLoading:h,isError:b}=de({queryKey:oe.detail(t),queryFn:()=>ne(xe,{id:t}),enabled:!!t});if(h)return e.jsx(me,{isDesktop:d});if(b||!(c!=null&&c.proposal))return ce(ie);const s=c.proposal,o=he(s.meetings,s.historicalProposals),j=be(s.mergedProposals);console.log({proposal:s});const g=je(s),x=((R=s.historicalParentProposals)==null?void 0:R.id)??((E=s.mergedParentProposals)==null?void 0:E.id),f=!!s.budgetImageUrl,l=s.budget,D=($=s.proposers)==null?void 0:$.map(r=>r.name).join("、"),C=s.coSigners&&s.coSigners.length>0?s.coSigners.map(r=>r.name).join("、"):"無",Y=ge(s.proposalTypes),A=fe(s.result),H=Ne((z=s.budget)==null?void 0:z.majorCategory,(U=s.budget)==null?void 0:U.mediumCategory,(V=s.budget)==null?void 0:V.minorCategory),B=!!(l!=null&&l.majorCategory)||!!(l!=null&&l.mediumCategory)||!!(l!=null&&l.minorCategory),L=(l==null?void 0:l.projectDescription)??"",P=L.trim().length>0,n=l,N=l==null?void 0:l.lastYearSettlement,S=N!=null,u=(n==null?void 0:n.lastYearLegalBudget)??null,T=u!=null,w=(n==null?void 0:n.lastYearComparison)??null,_=w!=null,y=B||P||S||T||_,v=B?H:"N/A",k=P?L:"N/A",W=S?a(N):"N/A",ee=T?a(u):"N/A",se=_?a(w):"N/A",le=!1,I=`${s.id}-${s.react_good}-${s.react_angry}-${s.react_disappoint}-${s.react_whatever}`;return d?e.jsx("div",{className:"pb-8 text-sm",children:e.jsxs("div",{className:"mx-2.5 flex flex-col md:mx-8",children:[e.jsx(p,{to:"/all-budgets",className:"underline",children:"<回到列表頁"}),e.jsxs("div",{className:"relative mt-6",children:[e.jsx("div",{className:"absolute h-full w-full translate-x-3 -translate-y-3 rounded-lg border-2 bg-neutral-200"}),e.jsxs("div",{className:"bg-surface-base relative flex flex-col rounded-lg border-2 p-5 pb-30",children:[e.jsxs("div",{className:"mb-4 flex gap-5 border-b-2 p-3 text-xl font-bold",children:[e.jsx("p",{children:"編號"}),e.jsx("p",{className:"text-budget-warning",children:s.id})]}),e.jsxs("div",{className:"flex flex-col gap-y-10",children:[e.jsxs("section",{className:"flex",children:[e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"分類"}),e.jsx("p",{className:"flex w-fit border-t pt-4 md:pr-8 lg:pr-12",children:((F=s.government)==null?void 0:F.category)||"分類"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"部會"}),e.jsx("p",{className:"flex w-fit border-t pt-4 md:pr-8 lg:pr-12",children:((O=s.government)==null?void 0:O.name)||"部會名稱"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"提案人（連署）"}),e.jsxs("p",{className:"flex w-fit border-t pt-4 md:pr-18 lg:pr-32",children:[D,e.jsx("br",{}),"（",C,"）"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"提案"}),e.jsx("p",{className:"flex w-fit border-t pt-4 md:pr-12",children:Y})]}),e.jsxs("div",{className:"grow",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"審議結果"}),e.jsx("p",{className:"flex border-t pt-4 pr-12",children:A})]})]}),e.jsxs("section",{className:"flex",children:[e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"審議階段"}),e.jsx("div",{className:"flex w-fit border-t pt-4 pr-13 md:pr-24",children:o.length>0?e.jsx(Z,{items:o}):e.jsx("p",{className:"text-gray-500",children:"暫無審議資料"})})]}),e.jsxs("div",{className:"grow",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"是否併案"}),e.jsxs("div",{className:"flex flex-col gap-y-4 border-t pt-4",children:[e.jsx("p",{children:g?"是":"否"}),x&&e.jsxs("div",{className:"flex flex-col gap-y-1 text-sm text-neutral-500",children:[e.jsx("p",{children:"請至主提案單確認結果"}),e.jsx(p,{to:`/budget/${x}`,className:"text-brand-primary underline",children:"查看主提案單"})]}),g&&j.length>0&&e.jsx("div",{className:"grid-rows-auto grid grid-cols-3 gap-4.5",children:j.map(r=>e.jsxs("div",{className:"flex gap-x-2",children:[e.jsx("div",{className:"mt-2 size-2 rounded-full bg-black"}),e.jsxs("div",{className:"text-neutral-500",children:[e.jsx("p",{className:"underline",children:r.date}),e.jsx("p",{children:r.proposers})]})]},r.id))})]})]})]}),e.jsx("section",{className:"flex",children:e.jsxs("div",{className:"grow",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"提案內容"}),e.jsx("div",{className:"flex flex-col gap-y-4 border-t pt-4",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:s.reason||s.description||"無提案內容"})})]})}),!f&&e.jsxs("section",{className:"flex",children:[e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"預算金額"}),e.jsx("p",{className:"text-brand-accent flex w-fit border-t border-black pt-4 pr-32 font-bold",children:a((Q=s.budget)==null?void 0:Q.budgetAmount)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"減列金額"}),e.jsx("p",{className:"text-brand-accent flex w-fit border-t border-black pt-4 pr-[136px] font-bold",children:a(s.reductionAmount)})]}),e.jsxs("div",{className:"grow",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"凍結金額"}),e.jsx("p",{className:"text-brand-accent flex border-t border-black pt-4 font-bold",children:a(s.freezeAmount)})]})]}),f&&e.jsxs("section",{className:"flex",children:[e.jsxs("div",{id:"left",className:"flex w-6/11 flex-col",children:[e.jsxs("div",{className:"flex",children:[e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"預算金額"}),e.jsx("p",{className:"text-brand-accent flex w-fit border-t border-black pt-4 font-bold md:pr-8 lg:pr-16 xl:pr-32",children:a((K=s.budget)==null?void 0:K.budgetAmount)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"減列金額"}),e.jsx("p",{className:"text-brand-accent flex w-fit border-t border-black pt-4 font-bold md:pr-8 lg:pr-16 xl:pr-32",children:a(s.reductionAmount)})]}),e.jsxs("div",{className:"grow",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"凍結金額"}),e.jsx("p",{className:"text-brand-accent flex border-t border-black pt-4 pr-[93px] font-bold",children:a(s.freezeAmount)})]})]}),y&&e.jsxs("div",{className:"mt-9 flex max-w-5/6 flex-col gap-y-9",children:[e.jsxs("div",{className:"grow",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"科目/計畫"}),e.jsx("p",{className:"flex border-t border-black pt-4 pr-9",children:v})]}),e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"計畫說明"}),e.jsx("p",{className:"flex border-t border-black pt-4 whitespace-pre-wrap",children:k})]})]})]}),e.jsxs("div",{id:"right",className:"w-5/11",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"提案單圖檔"}),e.jsx("div",{className:"flex border-t border-black pt-4 font-bold",children:e.jsx(m,{src:s.budgetImageUrl||"/icon/default-image.svg",alt:"proposal-image",className:"w-full"})})]})]}),!f&&y&&e.jsxs("section",{className:"flex",children:[e.jsxs("div",{className:"grow",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"科目/計畫"}),e.jsx("p",{className:"flex border-t border-black pt-4 pr-9",children:v})]}),e.jsxs("div",{className:"w-[478px] max-w-[478px]",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"計畫說明"}),e.jsx("p",{className:"flex border-t border-black pt-4 whitespace-pre-wrap",children:k})]})]}),le,e.jsx("section",{className:"mt-25 flex justify-center gap-x-10",children:e.jsx(J,{proposal:s},I)})]})]})]})]})}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mx-2.5 mb-4 flex flex-col",children:[e.jsx(p,{to:"/all-budgets",className:"underline",children:"<回到列表頁"}),e.jsxs("div",{className:"mt-2 border-2 px-2 py-3",children:[e.jsxs("section",{className:"flex gap-6 pb-2 border-b border-neutral-250",children:[e.jsx("p",{children:"編號"}),e.jsx("p",{className:"text-budget-warning",children:s.id})]}),e.jsxs("section",{className:"flex gap-10 pb-4 border-b border-neutral-250 mt-3",children:[e.jsxs("div",{className:"flex flex-col gap-y-4 font-bold",children:[e.jsx("p",{children:"分類"}),e.jsx("p",{children:((M=s.government)==null?void 0:M.category)||"暫無分類"})]}),e.jsxs("div",{className:"flex flex-col gap-y-4 font-bold",children:[e.jsx("p",{children:"部會"}),e.jsx("p",{children:((q=s.government)==null?void 0:q.name)||"部會"})]})]}),e.jsxs("section",{children:[e.jsx("p",{className:"text-lg font-bold mt-3",children:"審議階段"}),e.jsx("div",{children:o.length>0?e.jsx(Z,{items:o}):e.jsx("p",{className:"text-gray-500",children:"暫無審議資料"})})]}),e.jsxs("div",{className:"mt-3 flex flex-col gap-y-3",children:[e.jsx("p",{className:"font-bold",children:"是否併案"}),e.jsx("p",{children:g?"是":"否"}),x&&e.jsx(p,{to:`/budget/${x}`,className:"text-brand-primary underline text-sm",children:"請至主提案單確認結果"})]}),e.jsx("ul",{className:"timeline timeline-vertical timeline-compact text-neutral-500",children:j.map(r=>e.jsxs("li",{children:[e.jsx("div",{className:"timeline-middle",children:e.jsx("div",{className:"h-3 w-3 rounded-full bg-gray-900"})}),e.jsxs("div",{className:"timeline-end rounded-xl bg-transparent px-6",children:[e.jsx("p",{children:r.date}),e.jsx("p",{children:r.proposers})]})]},r.id))}),e.jsx("div",{className:"my-4 h-px w-full bg-gray-300"}),e.jsxs("div",{className:"flex flex-col gap-y-3",children:[e.jsx("p",{className:"font-bold",children:"提案人（連署）"}),e.jsxs("section",{children:[e.jsx("p",{children:D}),e.jsxs("p",{children:["（",C,"）"]})]})]}),e.jsx("div",{className:"my-4 h-px w-full bg-gray-300"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("section",{className:"flex gap-x-12",children:[e.jsxs("section",{className:"flex-col",children:[e.jsx("p",{className:"font-bold",children:"提案"}),e.jsx("p",{children:Y})]}),e.jsxs("section",{className:"flex-col",children:[e.jsx("p",{className:"font-bold",children:"審議結果"}),e.jsx("p",{children:A})]})]}),e.jsx("a",{href:"#",className:"underline",target:"_blank",children:"資料來源"})]}),e.jsx("div",{className:"my-4 h-px w-full bg-gray-300"}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-4 font-bold",children:"提案內容"}),e.jsx("p",{className:"whitespace-pre-wrap",children:s.reason||s.description||"無提案內容"})]}),e.jsx("div",{className:"my-4 h-px w-full bg-gray-300"}),e.jsxs("div",{className:"flex gap-x-10",children:[e.jsxs("section",{className:"flex flex-col gap-y-4",children:[e.jsx("p",{className:"font-bold",children:"預算金額"}),e.jsx("p",{className:"text-budget-warning",children:a((G=s.budget)==null?void 0:G.budgetAmount)})]}),e.jsxs("section",{className:"flex flex-col gap-y-4",children:[e.jsx("p",{className:"font-bold",children:"減列金額"}),e.jsx("p",{className:"text-budget-warning",children:a(s.reductionAmount)})]})]}),e.jsx("div",{className:"my-4 h-px w-full bg-gray-300"}),e.jsxs("div",{className:"flex gap-x-10",children:[e.jsxs("section",{className:"flex flex-col gap-y-4",children:[e.jsx("p",{className:"font-bold",children:"凍結金額"}),e.jsx("p",{className:"text-budget-warning",children:a(s.freezeAmount)})]}),e.jsxs("section",{className:"flex flex-col gap-y-4",children:[e.jsx("p",{className:"font-bold",children:"預算書圖檔"}),e.jsx(m,{src:s.budgetImageUrl||"/icon/default-image.svg",alt:"default-image",className:"size-5"})]})]}),y&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"my-4 h-px w-full bg-gray-300"}),e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx("p",{className:"font-bold",children:"科目/計畫"}),e.jsx("button",{children:e.jsx(m,{src:"/icon/explain-term.svg",alt:"explain-term",className:"size-5"})})]}),e.jsx("a",{href:"#",className:"text-brand-primary underline",target:"_blank",children:"預算書連結"})]}),e.jsx("p",{children:v}),e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx("p",{className:"font-bold",children:"計畫說明"}),e.jsx("button",{children:e.jsx(m,{src:"/icon/explain-term.svg",alt:"explain-term",className:"size-5"})})]}),e.jsx("p",{className:"whitespace-pre-wrap",children:k})]}),e.jsx("div",{className:"my-4 h-px w-full bg-gray-300"}),e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx("p",{className:"font-bold",children:"上年度決算"}),e.jsx("p",{children:W})]}),e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx("p",{className:"font-bold",children:"上年度法定預算"}),e.jsx("p",{children:ee})]}),e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx("p",{className:"font-bold",children:"與上年度比較"}),e.jsx("p",{children:se})]})]})]}),e.jsx("section",{className:"gird-rows-auto mt-11 grid items-center justify-items-center gap-10",children:e.jsx(J,{proposal:s},I)})]})]})})},Pe=re(we);export{Pe as default};
