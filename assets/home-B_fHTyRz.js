import{p as e,y as F,x as p}from"./chunk-EPOLDU6W-BUbbWhPN.js";import{u as z,k as M}from"./gql-h-mhoVtL.js";import{S as U,I as g,b as V,G as B}from"./visualization.queries-D2sI7Yau.js";import{P as w,a as D,D as T}from"./progress-stages-526PVMKw.js";import{D as W}from"./year-S2-Q4BAH.js";const Z=t=>!!t&&w.includes(t),K=t=>!!t&&Object.hasOwn(T,t),v=t=>{if(!Z(t))return{stage:t,index:-1,percentage:0,label:"未知階段",isValid:!1};const n=w.indexOf(t),s=w.length,i=s?Math.round((n+1)/s*100):0;return{stage:t,index:n,percentage:i,label:D[t],isValid:!0}},Q=(t,n,s)=>{const i=v(n),a=K(s)?T[s]:"進行中";return{text:t?`${t} 年度中央政府總預算${a}`:"載入中...",percentage:i.percentage,stageLabel:i.label,stageMeta:i}};function q(t){return v(t).percentage}function H(t,n){return Q(t,null,n).text}const l={MINISTRY_REPORTING:"ministry-reporting",LEGISLATIVE_REVIEW:"legislative-review",UNFREEZE_COMPLETE:"unfreeze-complete"},X=[l.MINISTRY_REPORTING,l.LEGISLATIVE_REVIEW,l.UNFREEZE_COMPLETE],J={[l.MINISTRY_REPORTING]:"部會開始提出解凍報告",[l.LEGISLATIVE_REVIEW]:"立法院審議中",[l.UNFREEZE_COMPLETE]:"全數解凍案解凍完畢"},Y={[l.MINISTRY_REPORTING]:30,[l.LEGISLATIVE_REVIEW]:70,[l.UNFREEZE_COMPLETE]:100},x={pink:{border:"border-[#e9808e]",text:"text-[#e9808e]",bg:"bg-[#e9808e]"},blue:{border:"border-[#3e51ff]",text:"text-[#3e51ff]",bg:"bg-[#3e51ff]"}},I=t=>{if(!Number.isFinite(t))return 0;const n=Math.round(Number(t));return Math.min(100,Math.max(0,n))},_=t=>(t==null?void 0:t.trim())||"-";function ee({label:t,description:n,percentage:s,color:i="pink"}){const a=x[i]??x.pink,r=_(n),c=I(s),d=_(t);return e.jsxs("div",{className:"flex h-[35px] w-full max-w-[449px] items-center gap-0",role:"status","aria-live":"polite",children:[e.jsx("div",{className:`relative flex items-center justify-center rounded-l-[8px] border-2 bg-white ${a.border} h-full min-w-[124px] px-[10px]`,children:e.jsx("p",{className:`font-['Noto_Sans_TC:Bold',sans-serif] text-[16px] font-bold ${a.text} text-nowrap`,children:d})}),e.jsx("div",{className:`relative flex items-center ${a.bg} h-full flex-1 px-4`,children:e.jsx("p",{className:"overflow-hidden w-full text-center text-[16px] font-medium text-nowrap text-ellipsis text-white",children:r})}),e.jsx("div",{className:`flex items-center justify-center ${a.bg} h-full w-[2px]`,children:e.jsx("div",{className:"h-[35px] w-[2px] bg-white"})}),e.jsx("div",{className:`flex items-center justify-center ${a.bg} h-full min-w-[79px] rounded-r-[8px] px-4`,children:e.jsxs("p",{className:"font-['Noto_Sans_TC:Bold',sans-serif] text-[20px] font-bold text-nowrap text-white",children:[c,"%"]})})]})}const S=t=>(t==null?void 0:t.trim())||"-";function te({headerLabel:t,badges:n,headerColor:s}){var a;if(!n.length)return null;const i=x[s??((a=n[0])==null?void 0:a.color)??"blue"]??x.blue;return e.jsxs("div",{className:"flex w-full flex-col items-center pb-2",role:"status","aria-live":"polite",children:[e.jsxs("div",{className:"relative z-30 mb-[-8px] flex h-[35px] w-24 shrink-0 items-center justify-center rounded-lg bg-white p-2.5",children:[e.jsx("div",{"aria-hidden":"true",className:`pointer-events-none absolute inset-0 rounded-lg border-2 ${i.border}`}),e.jsx("p",{className:`relative shrink-0 whitespace-nowrap text-center text-sm font-bold ${i.text}`,children:S(t)})]}),n.map((r,c)=>{const d=x[r.color??"pink"]??x.pink,h=I(r.percentage);return e.jsxs("div",{className:`relative mb-[-8px] flex h-9 w-full shrink-0 items-center gap-1 rounded-lg px-3 last:mb-0 ${d.bg}`,style:{zIndex:20-c},children:[e.jsx("p",{className:"flex-1 whitespace-nowrap text-left text-sm font-medium text-white",children:S(r.description)}),e.jsx("div",{className:"flex h-9 w-0 shrink-0 items-center justify-center",children:e.jsx("div",{className:"rotate-90","aria-hidden":"true",children:e.jsx("svg",{className:"block",width:"36",height:"2",fill:"none",viewBox:"0 0 36 2",children:e.jsx("line",{stroke:"white",strokeWidth:"2",x2:"36",y1:"1",y2:"1"})})})}),e.jsxs("p",{className:"min-w-[42px] whitespace-nowrap text-right text-base font-bold text-white",children:[h,"%"]})]},`${r.label}-${c}`)})]})}const b="收錄歷年及最新中央政府預算審議情形，包含立委提案刪減和凍結的緣由和金額，便於搜尋及比較，更能即時追蹤最新審議進度。還可透過視覺化方式瀏覽，一目暸然。除了已數位化的資料，此平台也透過群眾協力（crowdsourcing）辨識提案掃描檔，歡迎至協作區加入合作行列。",E="【持續更新】中央政府總預算案審查監督平台",N="https://readr-media.github.io/congress-budget-watch-platform/",P=`${N}image/og.png`;function ce(){return[{title:E},{property:"og:title",content:E},{name:"description",content:b},{property:"og:description",content:b},{property:"og:url",content:N},{property:"og:type",content:"website"},{property:"og:image",content:P},{property:"og:image:width",content:"2400"},{property:"og:image:height",content:"1260"},{name:"twitter:card",content:"summary_large_image"},{property:"twitter:domain",content:"readr-media.github.io"},{property:"twitter:url",content:N},{name:"twitter:title",content:E},{name:"twitter:description",content:b},{name:"twitter:image",content:P}]}const xe=()=>[{rel:"preload",as:"image",href:`${U}/image/homepage-banner.svg`,fetchpriority:"high"}],re=new Set(X),ne=(t,n)=>{if(!(!!n&&re.has(n)))return{text:t?`${t} 年度中央政府總預算尚無解凍進度`:"暫無解凍進度資料",percentage:0,label:"尚無解凍進度",isValid:!1};const i=n,a=J[i],r=t?`${t} 年度中央政府總預算`:"";return{text:r?`${r}${a}`:a,percentage:Y[i],label:a,isValid:!0}},de=F(function(){var R,j;const n=W,{data:s,isLoading:i,isError:a}=z({queryKey:V.latest(),queryFn:()=>M(B,{skip:0,take:10})}),r=((R=s==null?void 0:s.budgetYears)==null?void 0:R.find(o=>o.year===n))??((j=s==null?void 0:s.budgetYears)==null?void 0:j[0])??null,c=r==null?void 0:r.budgetProgress,d=q(c),h=H((r==null?void 0:r.year)??null,(r==null?void 0:r.dataProgress)??null),y=ne((r==null?void 0:r.year)??null,(r==null?void 0:r.unfreezeProgress)??null),L={label:"最新審議進度",description:h,percentage:d,color:"pink"},k={label:"解凍進度",description:y.text,percentage:y.percentage,color:"blue"},f=[L,k],u=o=>e.jsx("div",{className:"max-w-banner -mt-1 flex w-full flex-col gap-3",children:o.map(m=>e.jsx("div",{className:`flex w-full items-center justify-center rounded-lg p-2 text-center text-sm font-medium ${m.className}`,children:m.text},m.key))}),G=u([{key:"progress-loading",text:"載入審議進度中...",className:"min-h-[60px] bg-gray-300 text-gray-600"},{key:"unfreeze-loading",text:"載入解凍進度中...",className:"min-h-[48px] bg-gray-300 text-gray-600"}]),O=u([{key:"progress-error",text:"審議進度載入失敗，請稍後再試",className:"min-h-[60px] bg-red-100 text-red-600"},{key:"unfreeze-error",text:"解凍進度載入失敗，請稍後再試",className:"min-h-[48px] bg-red-100 text-red-600"}]),A=u([{key:"progress-empty",text:"暫無審議進度資料",className:"min-h-[60px] bg-gray-300 text-gray-600"},{key:"unfreeze-empty",text:"暫無解凍進度資料",className:"min-h-[48px] bg-gray-300 text-gray-600"}]),C=()=>i?G:a?O:r?e.jsxs("div",{className:"max-w-banner -mt-1 w-full",children:[e.jsx("div",{className:"hidden flex-col gap-3 md:flex",children:f.map(o=>e.jsx(ee,{...o},o.label))}),e.jsx("div",{className:"flex w-full justify-center md:hidden",children:e.jsx(te,{headerLabel:f[0].label,headerColor:"blue",badges:f})})]}):A,$=[{label:"歷年預算",href:"/all-budgets"},{label:"最新年度預算",href:`/all-budgets?year=${n}`},{label:"視覺化專區",href:"/visualization"},{label:"協作區",href:"/collaboration"}];return e.jsxs("div",{className:"bg-background flex h-full flex-col justify-between p-5 md:p-8",children:[e.jsxs("div",{className:"mx-auto max-w-4xl",children:[e.jsxs("header",{className:"mb-8 text-center md:mb-12",children:[e.jsx("h1",{className:"mb-6 text-3xl font-bold text-gray-900 md:text-4xl",children:"中央政府總預算案審查監督平台"}),e.jsxs("div",{className:"relative mb-8 flex flex-col items-center justify-center",children:[e.jsx(g,{src:"/image/homepage-banner.svg",alt:"國會預算監督平台 Banner",width:380,height:189,loading:"eager",fetchPriority:"high",className:"h-auto w-full max-w-xl"}),C()]}),e.jsx("p",{className:"mx-auto max-w-2xl text-base leading-relaxed text-gray-700 md:text-lg",children:"收錄歷年及最新中央政府預算審議情形，包含立委提案刪減和凍結的緣由和金額，便於搜尋及比較，更能即時追蹤最新審議進度。還可透過視覺化方式瀏覽，一目暸然。除了已數位化的資料，此平台也透過群眾協力（crowdsourcing）辨識提案掃描檔，歡迎至協作區加入合作行列。"})]}),e.jsx("nav",{className:"flex flex-col gap-3 md:grid md:grid-cols-2 md:gap-6 lg:grid-cols-4 lg:gap-4","aria-label":"main navigate",children:$.map(o=>e.jsx(p,{to:o.href,className:({isActive:m})=>`border-brand-accent flex min-h-[72px] w-full items-center justify-center rounded-lg border-3 px-6 py-4 text-center text-lg font-medium transition-colors ${m?"bg-brand-accent":"hover:bg-brand-accent bg-white hover:text-black"} focus:ring-brand-accent text-budget-accent focus:ring-2 focus:ring-offset-2 focus:outline-none`,children:o.label},o.label))})]}),e.jsxs("div",{className:"mt-15 flex items-center justify-center gap-x-2 md:mt-25 md:gap-x-3",children:[e.jsx(p,{to:"https://www.readr.tw/",target:"_blank",rel:"noopener noreferrer","aria-label":"Readr",children:e.jsx(g,{src:"/image/readr-logo.svg",alt:"Readr logo",width:110,height:48})}),e.jsx(p,{to:"https://www.freiheit.org/zh/taiwan",target:"_blank",rel:"noopener noreferrer","aria-label":"Friedrich Naumann Foundation",children:e.jsx(g,{src:"/image/Friedrich-Naumann-Foundation-logo.svg",alt:"Friedrich-Naumann-Foundation-logo",width:130,height:48,className:"h-auto w-[130px] md:w-50"})}),e.jsx(p,{to:"https://ccw.org.tw/",target:"_blank",rel:"noopener noreferrer","aria-label":"Citizen Congress Watch",children:e.jsx(g,{src:"/image/CCW-logo.svg",alt:"Citizen-Watch-logo",width:90,height:48})}),e.jsx(g,{src:"/image/donate-CCW-logo.svg",alt:"donate-CCW-logo",width:120,height:48})]})]})});export{de as default,xe as links,ce as meta};
