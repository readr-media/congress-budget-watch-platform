import{G as ce,p as e,y as de,I as ne,D as ie,x as o}from"./chunk-4WY6JWTD-2Cr-QbDP.js";import{u as oe,j as xe,E as pe}from"./gql-lnTnoR53.js";import{I as p,p as me,f as be}from"./visualization.queries-B9rVTwkU.js";import{b as he}from"./index-Ck08PhAW.js";import{B as je}from"./budget-detail-skeleton-DMxLzU0j.js";import{V as J}from"./VoteButtons-wwgs6zGK.js";import{b as ge,c as fe,h as Ne,g as ue,d as we,e as ye,f as r,i as ve}from"./helpers-DosH6SHi.js";import"./middleware-By82NwCX.js";import"./mutation-BHOeKqoV.js";const X=()=>e.jsx("hr",{style:{width:"2px"}}),ke=({date:i,title:t,isFirst:d,historicalProposalId:c})=>{const m=ce(),b=()=>{c&&m(`/budget/${c}`)};return e.jsxs("li",{children:[!d&&e.jsx(X,{}),e.jsx("div",{className:"timeline-middle",children:e.jsx("div",{className:"h-3 w-3 rounded-full bg-gray-900"})}),e.jsx("div",{className:"timeline-end rounded-xl bg-transparent px-6 py-4 md:px-0",children:e.jsxs("div",{className:"flex items-center justify-between md:w-[200px] md:max-w-[200px]",children:[e.jsx("div",{className:"min-w-0 text-gray-900",children:e.jsxs("div",{className:"md:text-md text-base leading-7 font-normal md:leading-8",children:[e.jsx("time",{className:"font-inherit leading-inherit align-middle text-inherit lg:underline",children:i}),e.jsx("span",{className:"align-middle",children:t})]})}),c&&e.jsx("button",{type:"button",onClick:b,className:"ml-4 shrink-0 rounded-lg border border-black bg-white p-1 text-sm font-medium text-neutral-500 md:max-w-[44px] md:px-0 md:text-xs",children:"看版本變更"})]})}),e.jsx(X,{})]})},Z=({items:i})=>e.jsx("ul",{className:"timeline timeline-vertical timeline-compact",children:i.map((t,d)=>e.jsx(ke,{...t,isLast:d===i.length-1,isFirst:d===0},t.id))}),De=()=>{var I,$,z,E,U,V,F,M,O,Q,K,q,G;const{id:t}=ne(),d=he("(min-width: 768px)"),{data:c,isLoading:m,isError:b}=oe({queryKey:me.detail(t),queryFn:()=>xe(be,{id:t}),enabled:!!t});if(m)return e.jsx(je,{isDesktop:d});if(b||!(c!=null&&c.proposal))return ie(pe);const s=c.proposal,x=ge(s.meetings,s.historicalProposals),h=fe(s.mergedProposals,s.mergedParentProposals),j=Ne(s),g=!!s.budgetImageUrl,a=s.budget,k=(I=s.proposers)==null?void 0:I.map(l=>l.name).join("、"),D=s.coSigners&&s.coSigners.length>0?s.coSigners.map(l=>l.name).join("、"):"無",P=ue(s.proposalTypes),H=we(s.result),C=(($=s.historicalParentProposals)==null?void 0:$.id)??((z=s.mergedParentProposals)==null?void 0:z.id),Y=(l,re,te="flex")=>!ve(s)||!C?e.jsx("p",{className:l,children:H}):e.jsxs("p",{className:te,children:["請至",e.jsx(o,{to:`/budget/${C}`,className:re,children:"主提案單"}),"確認結果"]}),W=ye((E=s.budget)==null?void 0:E.majorCategory,(U=s.budget)==null?void 0:U.mediumCategory,(V=s.budget)==null?void 0:V.minorCategory),A=!!(a!=null&&a.majorCategory)||!!(a!=null&&a.mediumCategory)||!!(a!=null&&a.minorCategory),B=(a==null?void 0:a.projectDescription)??"",L=B.trim().length>0,n=a,f=a==null?void 0:a.lastYearSettlement,S=f!=null,N=(n==null?void 0:n.lastYearLegalBudget)??null,T=N!=null,u=(n==null?void 0:n.lastYearComparison)??null,_=u!=null,w=A||L||S||T||_,y=A?W:"N/A",v=L?B:"N/A",ee=S?r(f):"N/A",se=T?r(N):"N/A",le=_?r(u):"N/A",ae=!1,R=`${s.id}-${s.react_good}-${s.react_angry}-${s.react_disappoint}-${s.react_whatever}`;return d?e.jsx("div",{className:"pb-8 text-sm",children:e.jsxs("div",{className:"mx-2.5 flex flex-col md:mx-8",children:[e.jsx(o,{to:"/all-budgets",className:"underline",children:"<回到列表頁"}),e.jsxs("div",{className:"relative mt-6",children:[e.jsx("div",{className:"absolute h-full w-full translate-x-3 -translate-y-3 rounded-lg border-2 bg-neutral-200"}),e.jsxs("div",{className:"bg-surface-base relative flex flex-col rounded-lg border-2 p-5 pb-30",children:[e.jsxs("div",{className:"mb-4 flex gap-5 border-b-2 p-3 text-xl font-bold",children:[e.jsx("p",{children:"編號"}),e.jsx("p",{className:"text-budget-warning",children:s.id})]}),e.jsxs("div",{className:"flex flex-col gap-y-10",children:[e.jsxs("section",{className:"flex",children:[e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"分類"}),e.jsx("p",{className:"flex w-fit border-t pt-4 md:pr-8 lg:pr-12",children:((F=s.government)==null?void 0:F.category)||"分類"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"部會"}),e.jsx("p",{className:"flex w-fit border-t pt-4 md:pr-8 lg:pr-12",children:((M=s.government)==null?void 0:M.name)||"部會名稱"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"提案人（連署）"}),e.jsxs("p",{className:"flex w-fit border-t pt-4 md:pr-18 lg:pr-32",children:[k,e.jsx("br",{}),"（",D,"）"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"提案"}),e.jsx("p",{className:"flex w-fit border-t pt-4 md:pr-12",children:P})]}),e.jsxs("div",{className:"grow",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"審議結果"}),Y("flex border-t pt-4 pr-12 ","text-brand-primary flex underline","flex pt-4")]})]}),e.jsxs("section",{className:"flex",children:[e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"審議階段"}),e.jsx("div",{className:"flex w-fit border-t pt-4 pr-13 md:pr-24",children:x.length>0?e.jsx(Z,{items:x}):e.jsx("p",{className:"text-gray-500",children:"暫無審議資料"})})]}),e.jsxs("div",{className:"grow",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"是否併案"}),e.jsxs("div",{className:"flex flex-col gap-y-4 border-t pt-4",children:[e.jsx("p",{children:j?"是":"否"}),j&&h.length>0&&e.jsx("div",{className:"grid-rows-auto grid grid-cols-3 gap-4.5",children:h.map(l=>e.jsxs(o,{to:`/budget/${l.id}`,className:"hover:text-brand-primary flex gap-x-2 text-neutral-500",children:[e.jsx("div",{className:`mt-2 size-2 rounded-full ${l.isParent?"bg-brand-primary":"bg-black"}`,children:"主"}),e.jsxs("div",{children:[e.jsx("p",{className:"underline",children:l.date}),e.jsx("p",{children:l.proposers})]})]},l.id))})]})]})]}),e.jsx("section",{className:"flex",children:e.jsxs("div",{className:"grow",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"提案內容"}),e.jsx("div",{className:"flex flex-col gap-y-4 border-t pt-4",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:s.reason||s.description||"無提案內容"})})]})}),!g&&e.jsxs("section",{className:"flex",children:[e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"預算金額"}),e.jsx("p",{className:"text-brand-accent flex w-fit border-t border-black pt-4 pr-32 font-bold",children:r((O=s.budget)==null?void 0:O.budgetAmount)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"減列金額"}),e.jsx("p",{className:"text-brand-accent flex w-fit border-t border-black pt-4 pr-[136px] font-bold",children:r(s.reductionAmount)})]}),e.jsxs("div",{className:"grow",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"凍結金額"}),e.jsx("p",{className:"text-brand-accent flex border-t border-black pt-4 font-bold",children:r(s.freezeAmount)})]})]}),g&&e.jsxs("section",{className:"flex",children:[e.jsxs("div",{id:"left",className:"flex w-6/11 flex-col",children:[e.jsxs("div",{className:"flex",children:[e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"預算金額"}),e.jsx("p",{className:"text-brand-accent flex w-fit border-t border-black pt-4 font-bold md:pr-8 lg:pr-16 xl:pr-32",children:r((Q=s.budget)==null?void 0:Q.budgetAmount)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"減列金額"}),e.jsx("p",{className:"text-brand-accent flex w-fit border-t border-black pt-4 font-bold md:pr-8 lg:pr-16 xl:pr-32",children:r(s.reductionAmount)})]}),e.jsxs("div",{className:"grow",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"凍結金額"}),e.jsx("p",{className:"text-brand-accent flex border-t border-black pt-4 pr-[93px] font-bold",children:r(s.freezeAmount)})]})]}),w&&e.jsxs("div",{className:"mt-9 flex max-w-5/6 flex-col gap-y-9",children:[e.jsxs("div",{className:"grow",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"科目/計畫"}),e.jsx("p",{className:"flex border-t border-black pt-4 pr-9",children:y})]}),e.jsxs("div",{children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"計畫說明"}),e.jsx("p",{className:"flex border-t border-black pt-4 whitespace-pre-wrap",children:v})]})]})]}),e.jsxs("div",{id:"right",className:"w-5/11",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"提案單圖檔"}),e.jsx("div",{className:"flex border-t border-black pt-4 font-bold",children:e.jsx(p,{src:s.budgetImageUrl||"/icon/default-image.svg",alt:"proposal-image",className:"w-full"})})]})]}),!g&&w&&e.jsxs("section",{className:"flex",children:[e.jsxs("div",{className:"grow",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"科目/計畫"}),e.jsx("p",{className:"flex border-t border-black pt-4 pr-9",children:y})]}),e.jsxs("div",{className:"w-[478px] max-w-[478px]",children:[e.jsx("p",{className:"bg-brand-accent w-fit rounded-t-lg border-2 border-black px-2.5 py-1 text-white",children:"計畫說明"}),e.jsx("p",{className:"flex border-t border-black pt-4 whitespace-pre-wrap",children:v})]})]}),ae,e.jsx("section",{className:"mt-25 flex justify-center gap-x-10",children:e.jsx(J,{proposal:s},R)})]})]})]})]})}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mx-2.5 mb-4 flex flex-col",children:[e.jsx(o,{to:"/all-budgets",className:"underline",children:"<回到列表頁"}),e.jsxs("div",{className:"mt-2 border-2 px-2 py-3",children:[e.jsxs("section",{className:"border-neutral-250 flex gap-6 border-b pb-2",children:[e.jsx("p",{children:"編號"}),e.jsx("p",{className:"text-budget-warning",children:s.id})]}),e.jsxs("section",{className:"border-neutral-250 mt-3 flex gap-10 border-b pb-4",children:[e.jsxs("div",{className:"flex flex-col gap-y-4 font-bold",children:[e.jsx("p",{children:"分類"}),e.jsx("p",{children:((K=s.government)==null?void 0:K.category)||"暫無分類"})]}),e.jsxs("div",{className:"flex flex-col gap-y-4 font-bold",children:[e.jsx("p",{children:"部會"}),e.jsx("p",{children:((q=s.government)==null?void 0:q.name)||"部會"})]})]}),e.jsxs("section",{children:[e.jsx("p",{className:"mt-3 text-lg font-bold",children:"審議階段"}),e.jsx("div",{children:x.length>0?e.jsx(Z,{items:x}):e.jsx("p",{className:"text-gray-500",children:"暫無審議資料"})})]}),e.jsxs("div",{className:"mt-3 flex flex-col gap-y-3",children:[e.jsx("p",{className:"font-bold",children:"是否併案"}),e.jsx("p",{children:j?"是":"否"})]}),e.jsx("ul",{className:"timeline timeline-vertical timeline-compact text-neutral-500",children:h.map(l=>e.jsxs("li",{children:[e.jsx("div",{className:"timeline-middle",children:l.isParent?e.jsx("div",{className:"bg-brand-primary flex size-5 items-center justify-center rounded-full text-xs text-white",children:"主"}):e.jsx("div",{className:"size-2 rounded-full bg-black"})}),e.jsxs(o,{to:`/budget/${l.id}`,className:"timeline-end hover:text-brand-primary rounded-xl bg-transparent px-6 text-neutral-500",children:[e.jsx("p",{children:l.date}),e.jsx("p",{children:l.proposers})]})]},l.id))}),e.jsx("div",{className:"my-4 h-px w-full bg-gray-300"}),e.jsxs("div",{className:"flex flex-col gap-y-3",children:[e.jsx("p",{className:"font-bold",children:"提案人（連署）"}),e.jsxs("section",{children:[e.jsx("p",{children:k}),e.jsxs("p",{children:["（",D,"）"]})]})]}),e.jsx("div",{className:"my-4 h-px w-full bg-gray-300"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("section",{className:"flex gap-x-12",children:[e.jsxs("section",{className:"flex-col",children:[e.jsx("p",{className:"font-bold",children:"提案"}),e.jsx("p",{children:P})]}),e.jsxs("section",{className:"flex-col",children:[e.jsx("p",{className:"font-bold",children:"審議結果"}),Y("flex pt-4 pr-12","text-brand-primary flex underline")]})]}),e.jsx("a",{href:"#",className:"underline",target:"_blank",children:"資料來源"})]}),e.jsx("div",{className:"my-4 h-px w-full bg-gray-300"}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-4 font-bold",children:"提案內容"}),e.jsx("p",{className:"whitespace-pre-wrap",children:s.reason||s.description||"無提案內容"})]}),e.jsx("div",{className:"my-4 h-px w-full bg-gray-300"}),e.jsxs("div",{className:"flex gap-x-10",children:[e.jsxs("section",{className:"flex flex-col gap-y-4",children:[e.jsx("p",{className:"font-bold",children:"預算金額"}),e.jsx("p",{className:"text-budget-warning",children:r((G=s.budget)==null?void 0:G.budgetAmount)})]}),e.jsxs("section",{className:"flex flex-col gap-y-4",children:[e.jsx("p",{className:"font-bold",children:"減列金額"}),e.jsx("p",{className:"text-budget-warning",children:r(s.reductionAmount)})]})]}),e.jsx("div",{className:"my-4 h-px w-full bg-gray-300"}),e.jsxs("div",{className:"flex gap-x-10",children:[e.jsxs("section",{className:"flex flex-col gap-y-4",children:[e.jsx("p",{className:"font-bold",children:"凍結金額"}),e.jsx("p",{className:"text-budget-warning",children:r(s.freezeAmount)})]}),e.jsxs("section",{className:"flex flex-col gap-y-4",children:[e.jsx("p",{className:"font-bold",children:"預算書圖檔"}),e.jsx(p,{src:s.budgetImageUrl||"/icon/default-image.svg",alt:"default-image",className:"size-5"})]})]}),w&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"my-4 h-px w-full bg-gray-300"}),e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx("p",{className:"font-bold",children:"科目/計畫"}),e.jsx("button",{children:e.jsx(p,{src:"/icon/explain-term.svg",alt:"explain-term",className:"size-5"})})]}),e.jsx("a",{href:"#",className:"text-brand-primary underline",target:"_blank",children:"預算書連結"})]}),e.jsx("p",{children:y}),e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx("p",{className:"font-bold",children:"計畫說明"}),e.jsx("button",{children:e.jsx(p,{src:"/icon/explain-term.svg",alt:"explain-term",className:"size-5"})})]}),e.jsx("p",{className:"whitespace-pre-wrap",children:v})]}),e.jsx("div",{className:"my-4 h-px w-full bg-gray-300"}),e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx("p",{className:"font-bold",children:"上年度決算"}),e.jsx("p",{children:ee})]}),e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx("p",{className:"font-bold",children:"上年度法定預算"}),e.jsx("p",{children:se})]}),e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx("p",{className:"font-bold",children:"與上年度比較"}),e.jsx("p",{children:le})]})]})]}),e.jsx("section",{className:"gird-rows-auto mt-11 grid items-center justify-items-center gap-10",children:e.jsx(J,{proposal:s},R)})]})]})})},Re=de(De);export{Re as default};
